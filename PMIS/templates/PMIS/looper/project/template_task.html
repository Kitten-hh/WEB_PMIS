{% extends 'WEB_PMIS/main.html' %}
{% load static %}
{% load customer_filter %}
{% block header_jscss%}
<!-- BEGIN PLUGINS STYLES -->
<link rel="stylesheet"
    href="{% static 'BaseProject/vendor/Looper/assets/vendor/open-iconic/font/css/open-iconic-bootstrap.min.css' %}">
<link rel="stylesheet"
    href="{% static 'BaseProject/vendor/Looper/assets/vendor/@fortawesome/fontawesome-free/css/all.min.css' %}">
{% endblock%}
{% block content %}
<!-- .page -->
<div class="page">
    <!-- /Following Modal -->
    <!-- .page-inner -->
    <div class="page-inner">
        <!-- .page-title-bar -->
        <header class="page-title-bar">
            <h1 class="page-title"> Activities </h1>
        </header><!-- /.page-title-bar -->
        <!-- .page-section -->
        <ul class="nav nav-tabs" role="tablist">
            {% for row in data%}
            <li class="nav-item">
                {% if forloop.counter == 1 %}
                <a class="nav-link active" href="#{{row.category.tpmastid}}" data-toggle="tab" role="tab">{{row.category.tpdesc}}</a>
                {%else%}
                <a class="nav-link" href="#{{row.category.tpmastid}}" data-toggle="tab" role="tab">{{row.category.tpdesc}}</a>
                {%endif%}
            </li>
            {%endfor%}
        </ul>
        <div class="tab-content">
            {% for row in data%}
            {% if forloop.counter == 1 %}
                <div class="tab-pane fade active show" id="{{row.category.tpmastid}}" role="tabpanel">
                {% else %}
                <div class="tab-pane fade" id="{{row.category.tpmastid}}" role="tabpanel">
                {%endif%}
                <div class="page-section">
                    <!-- .section-block -->
                    <div class="section-block">
                        <ul class="timeline">
                            {% set local_day = None %}
                            {% for task in row.tasks%}
                            {% if not local_day or local_day|todayDiff != task.planbdate|todayDiff%}
                            {% if task.planbdate|todayDiff == 0%}
                            <h2 class="section-title"> Today </h2><!-- .timeline -->
                            {% elif task.planbdate|todayDiff == -1%}
                            <h2 class="section-title"> Yesterday </h2><!-- .timeline -->
                            {%else%}
                            <h2 class="section-title"> {{task.planbdate|date:'Y-n-d H:i'}} </h2><!-- .timeline -->
                            {%endif%}
                            {%endif%}
                            {% set local_day = task.planbdate %}
                            <!-- .timeline-item -->
                            <li class="timeline-item">
                                <!-- .timeline-figure -->
                                <div class="timeline-figure">
                                    <span class="tile tile-circle tile-sm"><i
                                            class="far fa-calendar-alt fa-lg"></i></span>
                                </div><!-- /.timeline-figure -->
                                <!-- .timeline-body -->
                                <div class="timeline-body">
                                    <!-- .media -->
                                    <div class="media">
                                        <!-- .media-body -->
                                        <div class="media-body">
                                            <h6 class="timeline-heading">
                                                <a href="#" class="text-link">{{task.task}}</a>
                                            </h6>
                                            <p class="mb-0">
                                                <a href="#">{{task.contact}}</a> {{row.category.tpdesc}} </p>
                                            <p class="timeline-date d-sm-none"> {{task.planbdate|timeago}}</p>
                                        </div><!-- /.media-body -->
                                        <!-- .media-right -->
                                        <div class="d-none d-sm-block">
                                            <span class="timeline-date">{{task.planbdate|timeago}}</span>
                                        </div><!-- /.media-right -->
                                    </div><!-- /.media -->
                                </div><!-- /.timeline-body -->
                            </li><!-- /.timeline-item -->
                            {% endfor %}
                        </ul>

                    </div><!-- /.section-block -->
                    <p class="text-center">
                        <button type="button" class="btn btn-light"><i class="fa fa-fw fa-angle-double-down"></i> Load
                            more</button>
                    </p>
                </div><!-- /.page-section -->
            </div>
            {%endfor%}
        </div>
        
    </div>
</div><!-- /.page-inner -->
</div><!-- /.page -->
{% endblock %}
{% block footer_jscss%}
<!-- BEGIN PLUGINS JS -->
<script src="{% static 'BaseProject/vendor/Looper/assets/vendor/pace-progress/pace.min.js' %}"></script>
<script src="{% static 'BaseProject/vendor/Looper/assets/vendor/stacked-menu/js/stacked-menu.min.js' %}"></script>
<script src="{% static 'BaseProject/vendor/Looper/assets/vendor/perfect-scrollbar/perfect-scrollbar.min.js' %}"></script>
{% endblock %}